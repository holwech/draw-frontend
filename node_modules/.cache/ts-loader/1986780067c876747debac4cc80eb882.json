{"remainingRequest":"/home/holwech/code/draw/node_modules/babel-loader/lib/index.js!/home/holwech/code/draw/node_modules/ts-loader/index.js??ref--13-2!/home/holwech/code/draw/src/draw/player/PlayController.ts","dependencies":[{"path":"/home/holwech/code/draw/src/draw/player/PlayController.ts","mtime":1553625573567},{"path":"/home/holwech/code/draw/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/holwech/code/draw/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/holwech/code/draw/node_modules/ts-loader/index.js","mtime":1540965372000}],"contextDependencies":[],"result":["import _classCallCheck from \"/home/holwech/code/draw/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/holwech/code/draw/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport Timer from '../utils/Timer';\nimport { EventType } from '../utils/boardInterfaces';\nimport { PlayStates } from './playInterfaces';\nexport var PlayController =\n/*#__PURE__*/\nfunction () {\n  function PlayController(app, state) {\n    _classCallCheck(this, PlayController);\n\n    this.app = app;\n    this.state = state;\n    this.state.timer = new Timer();\n    this.state.log = [];\n  }\n\n  _createClass(PlayController, [{\n    key: \"play\",\n    value: function play() {\n      switch (this.state.state) {\n        case PlayStates.PLAY:\n          break;\n\n        case PlayStates.PAUSE:\n          this.state.timer.start();\n          this.state.state = PlayStates.PLAY;\n          this.playEvents();\n          break;\n\n        case PlayStates.STOP:\n          this.reset();\n          this.state.timer.start();\n          this.state.state = PlayStates.PLAY;\n          this.playEvents();\n          break;\n\n        case PlayStates.REVERSE:\n          this.state.timer.start();\n          this.state.state = PlayStates.PLAY;\n          this.playEvents();\n          break;\n\n        default:\n          break;\n      }\n\n      this.state.state = PlayStates.PLAY;\n    }\n  }, {\n    key: \"pause\",\n    value: function pause() {\n      switch (this.state.state) {\n        case PlayStates.PLAY:\n          this.state.timer.pause();\n          break;\n\n        case PlayStates.PAUSE:\n          break;\n\n        case PlayStates.STOP:\n          this.state.timer.pause();\n          break;\n\n        case PlayStates.REVERSE:\n          this.state.timer.pause();\n          break;\n\n        default:\n          break;\n      }\n\n      this.state.state = PlayStates.PAUSE;\n    }\n  }, {\n    key: \"stop\",\n    value: function stop() {\n      switch (this.state.state) {\n        case PlayStates.PLAY:\n          this.state.timer.stop();\n          break;\n\n        case PlayStates.PAUSE:\n          this.state.timer.stop();\n          break;\n\n        case PlayStates.STOP:\n          break;\n\n        default:\n          break;\n      }\n\n      this.state.state = PlayStates.STOP;\n    }\n  }, {\n    key: \"reverse\",\n    value: function reverse() {\n      switch (this.state.state) {\n        case PlayStates.REVERSE:\n          break;\n\n        default:\n          this.app.dispatchEvent({\n            eventType: EventType.CLEAR\n          });\n          this.state.state = PlayStates.REVERSE;\n          this.state.timer.reverse();\n          this.reversePlayEvents();\n          break;\n      }\n    }\n  }, {\n    key: \"setEventLog\",\n    value: function setEventLog(log) {\n      this.state.log = log;\n    }\n  }, {\n    key: \"deleteEventLog\",\n    value: function deleteEventLog() {\n      this.state.log = [];\n    }\n  }, {\n    key: \"reset\",\n    value: function reset() {\n      this.app.dispatchEvent({\n        eventType: EventType.CLEAR\n      });\n      this.state.currIdx = 0;\n      this.state.timer.stop();\n    }\n  }, {\n    key: \"playEvents\",\n    value: function playEvents() {\n      var _this = this;\n\n      if (this.state.currIdx !== this.state.log.length) {\n        setTimeout(function () {\n          if (_this.state.state === PlayStates.PLAY) {\n            _this.app.dispatchEvent(_this.state.log[_this.state.currIdx]);\n\n            _this.state.currIdx++;\n\n            _this.playEvents();\n          }\n        }, this.state.log[this.state.currIdx].time - this.state.timer.getTime());\n      } else {\n        this.stop();\n      }\n    }\n  }, {\n    key: \"reversePlayEvents\",\n    value: function reversePlayEvents() {\n      var _this2 = this;\n\n      console.log('playing reverse');\n\n      if (this.state.currIdx >= 0) {\n        setTimeout(function () {\n          if (_this2.state.state === PlayStates.REVERSE) {\n            _this2.app.dispatchEvent(_this2.state.log[_this2.state.currIdx]);\n\n            _this2.state.currIdx--;\n\n            _this2.reversePlayEvents();\n          }\n        }, this.state.timer.getTime() - this.state.log[this.state.currIdx].time);\n      } else {\n        this.stop();\n      }\n    }\n  }]);\n\n  return PlayController;\n}();",{"version":3,"sources":["/home/holwech/code/draw/src/draw/player/PlayController.ts"],"names":[],"mappings":";;AAAA,OAAO,KAAP,MAAkB,gBAAlB;AACA,SAAiB,SAAjB,QAAkC,0BAAlC;AAEA,SAAS,UAAT,QAA2B,kBAA3B;AAGA,WAAa,cAAb;AAAA;AAAA;AAIE,0BAAY,GAAZ,EAAgC,KAAhC,EAAgD;AAAA;;AAC9C,SAAK,GAAL,GAAW,GAAX;AACA,SAAK,KAAL,GAAa,KAAb;AACA,SAAK,KAAL,CAAW,KAAX,GAAmB,IAAI,KAAJ,EAAnB;AACA,SAAK,KAAL,CAAW,GAAX,GAAiB,EAAjB;AACD;;AATH;AAAA;AAAA,2BAWa;AACT,cAAQ,KAAK,KAAL,CAAW,KAAnB;AACE,aAAK,UAAU,CAAC,IAAhB;AACE;;AACF,aAAK,UAAU,CAAC,KAAhB;AACE,eAAK,KAAL,CAAW,KAAX,CAAiB,KAAjB;AACA,eAAK,KAAL,CAAW,KAAX,GAAmB,UAAU,CAAC,IAA9B;AACA,eAAK,UAAL;AACA;;AACF,aAAK,UAAU,CAAC,IAAhB;AACE,eAAK,KAAL;AACA,eAAK,KAAL,CAAW,KAAX,CAAiB,KAAjB;AACA,eAAK,KAAL,CAAW,KAAX,GAAmB,UAAU,CAAC,IAA9B;AACA,eAAK,UAAL;AACA;;AACF,aAAK,UAAU,CAAC,OAAhB;AACE,eAAK,KAAL,CAAW,KAAX,CAAiB,KAAjB;AACA,eAAK,KAAL,CAAW,KAAX,GAAmB,UAAU,CAAC,IAA9B;AACA,eAAK,UAAL;AACA;;AACF;AACE;AApBJ;;AAsBA,WAAK,KAAL,CAAW,KAAX,GAAmB,UAAU,CAAC,IAA9B;AACD;AAnCH;AAAA;AAAA,4BAqCc;AACV,cAAQ,KAAK,KAAL,CAAW,KAAnB;AACE,aAAK,UAAU,CAAC,IAAhB;AACE,eAAK,KAAL,CAAW,KAAX,CAAiB,KAAjB;AACA;;AACF,aAAK,UAAU,CAAC,KAAhB;AACE;;AACF,aAAK,UAAU,CAAC,IAAhB;AACE,eAAK,KAAL,CAAW,KAAX,CAAiB,KAAjB;AACA;;AACF,aAAK,UAAU,CAAC,OAAhB;AACE,eAAK,KAAL,CAAW,KAAX,CAAiB,KAAjB;AACA;;AACF;AACE;AAbJ;;AAeA,WAAK,KAAL,CAAW,KAAX,GAAmB,UAAU,CAAC,KAA9B;AACD;AAtDH;AAAA;AAAA,2BAwDa;AACT,cAAQ,KAAK,KAAL,CAAW,KAAnB;AACE,aAAK,UAAU,CAAC,IAAhB;AACE,eAAK,KAAL,CAAW,KAAX,CAAiB,IAAjB;AACA;;AACF,aAAK,UAAU,CAAC,KAAhB;AACE,eAAK,KAAL,CAAW,KAAX,CAAiB,IAAjB;AACA;;AACF,aAAK,UAAU,CAAC,IAAhB;AACE;;AACF;AACE;AAVJ;;AAYA,WAAK,KAAL,CAAW,KAAX,GAAmB,UAAU,CAAC,IAA9B;AACD;AAtEH;AAAA;AAAA,8BAwEgB;AACZ,cAAQ,KAAK,KAAL,CAAW,KAAnB;AACE,aAAK,UAAU,CAAC,OAAhB;AACE;;AACF;AACE,eAAK,GAAL,CAAS,aAAT,CAAuB;AAAE,YAAA,SAAS,EAAE,SAAS,CAAC;AAAvB,WAAvB;AACA,eAAK,KAAL,CAAW,KAAX,GAAmB,UAAU,CAAC,OAA9B;AACA,eAAK,KAAL,CAAW,KAAX,CAAiB,OAAjB;AACA,eAAK,iBAAL;AACA;AARJ;AAUD;AAnFH;AAAA;AAAA,gCAqFqB,GArFrB,EAqFkC;AAC9B,WAAK,KAAL,CAAW,GAAX,GAAiB,GAAjB;AACD;AAvFH;AAAA;AAAA,qCAyFuB;AACnB,WAAK,KAAL,CAAW,GAAX,GAAiB,EAAjB;AACD;AA3FH;AAAA;AAAA,4BA6Fe;AACX,WAAK,GAAL,CAAS,aAAT,CAAuB;AAAE,QAAA,SAAS,EAAE,SAAS,CAAC;AAAvB,OAAvB;AACA,WAAK,KAAL,CAAW,OAAX,GAAqB,CAArB;AACA,WAAK,KAAL,CAAW,KAAX,CAAiB,IAAjB;AACD;AAjGH;AAAA;AAAA,iCAmGoB;AAAA;;AAChB,UAAI,KAAK,KAAL,CAAW,OAAX,KAAuB,KAAK,KAAL,CAAW,GAAX,CAAe,MAA1C,EAAkD;AAChD,QAAA,UAAU,CAAC,YAAK;AACd,cAAI,KAAI,CAAC,KAAL,CAAW,KAAX,KAAqB,UAAU,CAAC,IAApC,EAA0C;AACxC,YAAA,KAAI,CAAC,GAAL,CAAS,aAAT,CAAuB,KAAI,CAAC,KAAL,CAAW,GAAX,CAAe,KAAI,CAAC,KAAL,CAAW,OAA1B,CAAvB;;AACA,YAAA,KAAI,CAAC,KAAL,CAAW,OAAX;;AACA,YAAA,KAAI,CAAC,UAAL;AACD;AACF,SANS,EAMP,KAAK,KAAL,CAAW,GAAX,CAAe,KAAK,KAAL,CAAW,OAA1B,EAAmC,IAAnC,GAA2C,KAAK,KAAL,CAAW,KAAX,CAAiB,OAAjB,EANpC,CAAV;AAOD,OARD,MAQO;AACL,aAAK,IAAL;AACD;AACF;AA/GH;AAAA;AAAA,wCAiH2B;AAAA;;AACvB,MAAA,OAAO,CAAC,GAAR,CAAY,iBAAZ;;AACA,UAAI,KAAK,KAAL,CAAW,OAAX,IAAsB,CAA1B,EAA6B;AAC3B,QAAA,UAAU,CAAC,YAAK;AACd,cAAI,MAAI,CAAC,KAAL,CAAW,KAAX,KAAqB,UAAU,CAAC,OAApC,EAA6C;AAC3C,YAAA,MAAI,CAAC,GAAL,CAAS,aAAT,CAAuB,MAAI,CAAC,KAAL,CAAW,GAAX,CAAe,MAAI,CAAC,KAAL,CAAW,OAA1B,CAAvB;;AACA,YAAA,MAAI,CAAC,KAAL,CAAW,OAAX;;AACA,YAAA,MAAI,CAAC,iBAAL;AACD;AACF,SANS,EAMP,KAAK,KAAL,CAAW,KAAX,CAAiB,OAAjB,KAA6B,KAAK,KAAL,CAAW,GAAX,CAAe,KAAK,KAAL,CAAW,OAA1B,EAAmC,IANzD,CAAV;AAOD,OARD,MAQO;AACL,aAAK,IAAL;AACD;AACF;AA9HH;;AAAA;AAAA","sourcesContent":["import Timer from '../utils/Timer';\nimport { IEvent, EventType } from '../utils/boardInterfaces';\nimport { AppController } from '../AppController';\nimport { PlayStates } from './playInterfaces';\nimport PlayState from './PlayState';\n\nexport class PlayController {\n  private app: AppController;\n  private state: PlayState;\n\n  constructor(app: AppController, state: PlayState) {\n    this.app = app;\n    this.state = state;\n    this.state.timer = new Timer();\n    this.state.log = [];\n  }\n\n  public play(): void {\n    switch (this.state.state) {\n      case PlayStates.PLAY:\n        break;\n      case PlayStates.PAUSE:\n        this.state.timer.start();\n        this.state.state = PlayStates.PLAY;\n        this.playEvents();\n        break;\n      case PlayStates.STOP:\n        this.reset();\n        this.state.timer.start();\n        this.state.state = PlayStates.PLAY;\n        this.playEvents();\n        break;\n      case PlayStates.REVERSE:\n        this.state.timer.start();\n        this.state.state = PlayStates.PLAY;\n        this.playEvents();\n        break;\n      default:\n        break;\n    }\n    this.state.state = PlayStates.PLAY;\n  }\n\n  public pause(): void {\n    switch (this.state.state) {\n      case PlayStates.PLAY:\n        this.state.timer.pause();\n        break;\n      case PlayStates.PAUSE:\n        break;\n      case PlayStates.STOP:\n        this.state.timer.pause();\n        break;\n      case PlayStates.REVERSE:\n        this.state.timer.pause();\n        break;\n      default:\n        break;\n    }\n    this.state.state = PlayStates.PAUSE;\n  }\n\n  public stop(): void {\n    switch (this.state.state) {\n      case PlayStates.PLAY:\n        this.state.timer.stop();\n        break;\n      case PlayStates.PAUSE:\n        this.state.timer.stop();\n        break;\n      case PlayStates.STOP:\n        break;\n      default:\n        break;\n    }\n    this.state.state = PlayStates.STOP;\n  }\n\n  public reverse(): void {\n    switch (this.state.state) {\n      case PlayStates.REVERSE:\n        break;\n      default:\n        this.app.dispatchEvent({ eventType: EventType.CLEAR });\n        this.state.state = PlayStates.REVERSE;\n        this.state.timer.reverse();\n        this.reversePlayEvents();\n        break;\n    }\n  }\n\n  public setEventLog(log: IEvent[]): void {\n    this.state.log = log;\n  }\n\n  public deleteEventLog(): void {\n    this.state.log = [];\n  }\n\n  private reset(): void {\n    this.app.dispatchEvent({ eventType: EventType.CLEAR });\n    this.state.currIdx = 0;\n    this.state.timer.stop();\n  }\n\n  private playEvents(): void {\n    if (this.state.currIdx !== this.state.log.length) {\n      setTimeout(() => {\n        if (this.state.state === PlayStates.PLAY) {\n          this.app.dispatchEvent(this.state.log[this.state.currIdx]);\n          this.state.currIdx++;\n          this.playEvents();\n        }\n      }, this.state.log[this.state.currIdx].time! - this.state.timer.getTime());\n    } else {\n      this.stop();\n    }\n  }\n\n  private reversePlayEvents(): void {\n    console.log('playing reverse');\n    if (this.state.currIdx >= 0) {\n      setTimeout(() => {\n        if (this.state.state === PlayStates.REVERSE) {\n          this.app.dispatchEvent(this.state.log[this.state.currIdx]);\n          this.state.currIdx--;\n          this.reversePlayEvents();\n        }\n      }, this.state.timer.getTime() - this.state.log[this.state.currIdx].time!);\n    } else {\n      this.stop();\n    }\n  }\n}\n"],"sourceRoot":""}]}